{% extends "base.html" %}

{% block title %}Vehicle Auction - Marketplace, Made Simple{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-primary text-white py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold mb-3">Marketplace, Made Simple.</h1>
                <p class="lead mb-4">Find your next vehicle at auction prices. Browse thousands of cars, trucks, and SUVs from trusted sellers.</p>
                <div class="d-flex gap-3">
                    <a href="{{ url_for('vehicles.list_vehicles') }}" class="btn btn-light btn-lg">
                        <i class="bi bi-search me-2"></i>Browse Inventory
                    </a>
                    <a href="{{ url_for('auctions.list_auctions') }}" class="btn btn-outline-light btn-lg">
                        <i class="bi bi-hammer me-2"></i>Live Auctions
                    </a>
                </div>
            </div>
            <div class="col-lg-6 d-none d-lg-block">
                <img src="{{ url_for('static', filename='img/hero-car.svg') }}" alt="Vehicle" class="img-fluid">
            </div>
        </div>
    </div>
</section>

<!-- Search/Filter Section -->
<section class="bg-light py-4">
    <div class="container">
        <form action="{{ url_for('vehicles.list_vehicles') }}" method="get" class="row g-3">
            <div class="col-md-3">
                <select name="make" class="form-select">
                    <option value="">All Makes</option>
                    <option value="Toyota">Toyota</option>
                    <option value="Honda">Honda</option>
                    <option value="Ford">Ford</option>
                    <option value="Chevrolet">Chevrolet</option>
                    <option value="BMW">BMW</option>
                    <option value="Mercedes-Benz">Mercedes-Benz</option>
                </select>
            </div>
            <div class="col-md-2">
                <select name="year_min" class="form-select">
                    <option value="">Min Year</option>
                    {% for year in range(2024, 1999, -1) %}
                        <option value="{{ year }}">{{ year }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2">
                <select name="year_max" class="form-select">
                    <option value="">Max Year</option>
                    {% for year in range(2024, 1999, -1) %}
                        <option value="{{ year }}">{{ year }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <select name="price_max" class="form-select">
                    <option value="">Max Price</option>
                    <option value="5000">Under $5,000</option>
                    <option value="10000">Under $10,000</option>
                    <option value="20000">Under $20,000</option>
                    <option value="30000">Under $30,000</option>
                    <option value="50000">Under $50,000</option>
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-search me-1"></i>Search
                </button>
            </div>
        </form>
    </div>
</section>

<!-- Featured Vehicles -->
<section class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="mb-0">Featured Vehicles</h2>
            <a href="{{ url_for('vehicles.list_vehicles') }}" class="btn btn-outline-primary">View All</a>
        </div>
        
        <div class="row g-4" id="featured-vehicles">
            <!-- Vehicle cards will be loaded here -->
            <div class="col-12 text-center py-5">
                <p class="text-muted">Loading vehicles...</p>
            </div>
        </div>
    </div>
</section>

<!-- Live Auctions -->
<section class="bg-light py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="mb-0">
                <i class="bi bi-broadcast text-danger me-2"></i>Live Auctions
            </h2>
            <a href="{{ url_for('auctions.list_auctions') }}" class="btn btn-outline-primary">View All</a>
        </div>
        
        <div class="row g-4" id="live-auctions">
            <!-- Auction cards will be loaded here -->
            <div class="col-12 text-center py-5">
                <p class="text-muted">No active auctions at the moment.</p>
            </div>
        </div>
    </div>
</section>

<!-- How It Works -->
<section class="py-5">
    <div class="container">
        <h2 class="text-center mb-5">How It Works</h2>
        <div class="row g-4">
            <div class="col-md-4 text-center">
                <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                    <i class="bi bi-person-plus fs-2"></i>
                </div>
                <h4>1. Sign Up</h4>
                <p class="text-muted">Create an account, verify your ID, and add a payment method.</p>
            </div>
            <div class="col-md-4 text-center">
                <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                    <i class="bi bi-search fs-2"></i>
                </div>
                <h4>2. Find Your Vehicle</h4>
                <p class="text-muted">Browse inventory, filter by make, model, year, and price.</p>
            </div>
            <div class="col-md-4 text-center">
                <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                    <i class="bi bi-hammer fs-2"></i>
                </div>
                <h4>3. Bid & Win</h4>
                <p class="text-muted">Place bids, win auctions, and we handle title and transport.</p>
            </div>
        </div>
        <div class="text-center mt-4">
            <a href="{{ url_for('main.how_it_works') }}" class="btn btn-outline-primary">Learn More</a>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Load featured vehicles on page load
document.addEventListener('DOMContentLoaded', function() {
    fetch('/api/vehicles?per_page=8')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('featured-vehicles');
            if (data.vehicles.length === 0) {
                container.innerHTML = '<div class="col-12 text-center py-5"><p class="text-muted">No vehicles available at the moment.</p></div>';
                return;
            }
            
            container.innerHTML = data.vehicles.map(vehicle => `
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm">
                        <img src="${vehicle.primary_image_url || '/static/img/no-image.svg'}" 
                             class="card-img-top" alt="${vehicle.year} ${vehicle.make} ${vehicle.model}"
                             style="height: 180px; object-fit: cover;">
                        <div class="card-body">
                            <h6 class="card-title mb-1">${vehicle.year} ${vehicle.make} ${vehicle.model}</h6>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-speedometer2 me-1"></i>${vehicle.mileage?.toLocaleString() || 'N/A'} mi
                                <span class="mx-2">|</span>
                                <i class="bi bi-file-text me-1"></i>${vehicle.title_type}
                            </p>
                            <p class="fw-bold text-primary mb-0">$${vehicle.starting_price?.toLocaleString() || 'N/A'}</p>
                        </div>
                        <div class="card-footer bg-transparent">
                            <a href="/vehicles/${vehicle.id}" class="btn btn-outline-primary btn-sm w-100">View Details</a>
                        </div>
                    </div>
                </div>
            `).join('');
        })
        .catch(error => {
            console.error('Error loading vehicles:', error);
        });
});
</script>
{% endblock %}
